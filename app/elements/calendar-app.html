<dom-module id="calendar-app">
  <style>
    :host {
      display: block;
    }
  </style>
  <template>
    <full-calendar config="{{config()}}" events="{{events()}}"></full-calendar>
  </template>
  <script>
    Polymer({
      is: 'calendar-app',
      events: function() {
        return [
          {
            url: 'http://localhost:9000/v1/users/USER-aba62cd5-caa6-4e42-a5d6-4909f03038bf/occurrences',
            eventDataTransform: function(event) {
              event.start = moment.tz(event.start, 'Europe/Amsterdam');
              event.end = moment.tz(event.end, 'Europe/Amsterdam');

              return event;
            }
          },
          {
            events: []
          }
        ];
      },
      config: function() {
          return {
            editable: true,

            defaultView: 'agendaWeek',
            timeFormat: 'H:mm',
            axisFormat: 'H:mm',
            slotLabelFormat: 'H:mm',
            timezone: 'local',

            droppable: true,

            header:{
              left: 'agendaDay agendaWeek month',
              center: 'title',
              right: 'today prev,next'
            },

            allDayText: 'All Day',

            dayClick:     function(event, jsEvent, view) { $scope.dayClicked(event, jsEvent, view);    },
            eventClick:   function(event, jsEvent, view) { $scope.eventClicked(event, jsEvent, view);  },
            eventDrop:    function(event, delta, revertFunc) { $scope.eventDropped(event, delta, revertFunc);  },
            eventResize:  function(event) { $scope.eventResize(event);},
            drop:         function(date) {
              // this references the event that is being dropped
              $scope.drop(this, date);
              $(this).remove();
            }
        };
      }
    });
  </script>
</dom-module>
