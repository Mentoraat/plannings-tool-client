<dom-module id="full-calendar">
  <style>
    :host {
      display: block;
    }
  </style>
  <template>
    <div id="calendar">

    </div>
  </template>
  <script>
    Polymer({
      is: 'full-calendar',

      properties: {
        config: {
          type: Object
        },
        events: {
          type: Array,
          observer: 'observeEvents'
        }
      },

      attached: function() {
        this.async(function() {
          var calendar = this.config;
          calendar.eventSources = this.events;
          $(this.$.calendar).fullCalendar(calendar);
        });
      },

      /*
        Refetching of events doesn't work.
        This uses the same solution as ui-angular,
        where we have to destroy THE WHOLE CALENDAR,
        and then recreate it. /sadface
        @see https://github.com/angular-ui/ui-calendar/blob/6e0c509e6a822926893334545f9af53fdb439a8a/src/calendar.js#L334
      */
      observeEvents: function(newValue, oldValue) {
        if (oldValue !== undefined) {
          this.refetchEvents();
        }
      },

      refetchEvents: function() {
        $(this.$.calendar).fullCalendar('refetchEvents');
      },

      rerenderEvents: function() {
        $(this.$.calendar).fullCalendar('rerenderEvents');
      }
    });
  </script>
</dom-module>
